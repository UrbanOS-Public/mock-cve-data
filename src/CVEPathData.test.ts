import { PATH_DATA_DIR } from './configuration';
import CVEPathData from './CVEPathData';

describe('PathData', () => {
    let cvePathData: CVEPathData;
    const fakeJsonName = 'test_json';
    const fakePath = [{ key: 'one' }, { key: 'two' }];

    beforeEach(async () => {
        jest.resetModules();
        jest.restoreAllMocks();
        jest.mock(`${PATH_DATA_DIR}/${fakeJsonName}.json`, () => fakePath, {
            virtual: true,
        });
        cvePathData = new CVEPathData([fakeJsonName]);
        await cvePathData.load();
    });

    it('Maps the id to the corresponding json', () => {
        expect(cvePathData.paths.get(fakeJsonName)).toEqual(fakePath);
    });
});
