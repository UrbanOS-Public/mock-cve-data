import app from '../app';
import supertest from 'supertest';
import * as MockVehicleManager from '../__mocks__/VehicleManager';
import * as VehicleManager from '../VehicleManager';
import { RESET_SUCCESS } from '../configuration';

const { mockResetVehicles } =
    VehicleManager as unknown as typeof MockVehicleManager;

jest.mock('../VehicleManager');

describe('/reset', () => {
    it('200: /reset calls manager to reset vehicles', async () => {
        const res = await supertest(app).get('/reset');
        expect(mockResetVehicles).toHaveBeenCalledTimes(1);
        expect(res.text).toEqual(`{"status":"${RESET_SUCCESS}"}`);
    });
});
